#!/bin/bash
#SBATCH --mem-per-cpu=24gb
#SBATCH --time=24:00:00
#SBATCH --job-name=msms
#SBATCH --error=msms
#SBATCH --output=msms
#SBATCH --partition=mpi
#SBATCH --ntasks=1

module load python2/2.7.13
module load jdk
export PYTHONPATH=$PYTHONPATH:~/work/scripts/genomics_general-master

IDSL=$((SLURM_ARRAY_TASK_ID -1))
ID=146

cd /work/rpapa/sbelleghem/msms_fd_fst/msms_run5

#273
#pos=(0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5)
#rec=(0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.00225 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.003375 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.0050625 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.00759375 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.011390625 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.017085938 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.025628906 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.038443359 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.057665039 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.086497559 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338 0.129746338)

#168
#pos=(0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5 0.5 -1.5 -3.5 -5.5 -7.5 -9.5 -11.5 -13.5 -15.5 -17.5 -19.5 -21.5 -23.5 -25.5 -27.5 -29.5 -31.5 -33.5 -35.5 -37.5 -39.5)
#rec=(0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.000625 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08)

#147
pos=(0.5 -9.5 -19.5 -29.5 -39.5 -49.5 -59.5 -69.5 -79.5 -89.5 -99.5 -109.5 -119.5 -129.5 -139.5 -149.5 -159.5 -169.5 -179.5 -189.5 -199.5 0.5 -9.5 -19.5 -29.5 -39.5 -49.5 -59.5 -69.5 -79.5 -89.5 -99.5 -109.5 -119.5 -129.5 -139.5 -149.5 -159.5 -169.5 -179.5 -189.5 -199.5 0.5 -9.5 -19.5 -29.5 -39.5 -49.5 -59.5 -69.5 -79.5 -89.5 -99.5 -109.5 -119.5 -129.5 -139.5 -149.5 -159.5 -169.5 -179.5 -189.5 -199.5 0.5 -9.5 -19.5 -29.5 -39.5 -49.5 -59.5 -69.5 -79.5 -89.5 -99.5 -109.5 -119.5 -129.5 -139.5 -149.5 -159.5 -169.5 -179.5 -189.5 -199.5 0.5 -9.5 -19.5 -29.5 -39.5 -49.5 -59.5 -69.5 -79.5 -89.5 -99.5 -109.5 -119.5 -129.5 -139.5 -149.5 -159.5 -169.5 -179.5 -189.5 -199.5 0.5 -9.5 -19.5 -29.5 -39.5 -49.5 -59.5 -69.5 -79.5 -89.5 -99.5 -109.5 -119.5 -129.5 -139.5 -149.5 -159.5 -169.5 -179.5 -189.5 -199.5 0.5 -9.5 -19.5 -29.5 -39.5 -49.5 -59.5 -69.5 -79.5 -89.5 -99.5 -109.5 -119.5 -129.5 -139.5 -149.5 -159.5 -169.5 -179.5 -189.5 -199.5)
rec=(0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.00125 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08 0.08)

count=0


for m in 0.0000001 0.000001 0.00001;
do for spl in 1000000 100000 10000;
do for ms in 100 1000 10000 100000 1000000;
do for s in 2000000 200000 20000 2000; 
do
count=$((count+1));
if [ "$count" == "$((SLURM_ARRAY_TASK_ID -1))" ] && [ ! -f msms_run1_r$(echo "${rec[ID]}")_pos$(echo "${pos[ID]}")_m$(echo ${m})_mchange$(echo ${ms})_split$(echo ${spl})_s$(echo ${s}) ]; 
then python /work/rpapa/sbelleghem/msms_fd_fst/msms_seqgen.py --Nsam 40 --pops 10 10 10 10 \
--theta 0.027 --thetaIsProp --recRate $(echo "${rec[ID]}") --Ne 1000000 --length 10000 --Nsim 100 \
--join $(echo ${spl}) 4 3 \
--join 2000000 3 2 \
--join 4000000 2 1 \
--selection \
--selStartTime $(echo ${s}) \
--selStartFreqs 0 0 0.01 0.01 \
--selCoefficient 0.2 \
--selChange 0 1 400000 200000 0 \
--selChange 0 2 400000 200000 0 \
--selChange 0 3 0 200000 400000 \
--selChange 0 4 0 200000 400000 \
--hetEffect 0.5 \
--mig 2 3 $(echo ${m}) \
--mig 3 2 $(echo ${m}) \
--migChange $(echo ${ms}) 2 3 0 \
--migChange $(echo ${ms}) 3 2 0 \
--mu 2e-9 \
--selMu 0.1 \
--selPos $(echo "${pos[ID]}") \
-o msms_run1_r$(echo "${rec[ID]}")_pos$(echo "${pos[ID]}")_m$(echo ${m})_mchange$(echo ${ms})_split$(echo ${spl})_s$(echo ${s}) --migsInProportions --timesInGenerations; fi; done; done; done; done

